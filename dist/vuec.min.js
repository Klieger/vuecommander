!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Vuec=e()}(this,function(){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function e(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}var t=function(){function i(){s(this,i);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.fields=e}return e(i,[{key:"implementedBy",value:function(e){this.fields.forEach(function(t){if(!e[t])throw new Error("Class ".concat(e.constructor.name,' does not implement method "').concat(t,'"'))})}}]),i}(),r=function(){function t(){s(this,t),this.history=[]}return e(t,[{key:"clear",value:function(){this.history=[]}},{key:"push",value:function(t){return this.history.push(t)}},{key:"pop",value:function(){return this.history.pop()}}]),t}(),o=function(){function t(){s(this,t),this.listeners={}}return e(t,[{key:"subscribe",value:function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)}},{key:"unsubscribe",value:function(t,e){var n=this.listeners[t];if(!n)return-1;var i=n.indexOf(e);return-1<i&&n.splice(i,1),this.listeners[t]=n,i}},{key:"notify",value:function(n,i){var t=this.listeners[n];if(!t)return-1;var s=[];return t.forEach(function(t){var e={eventType:n,data:i};t.update(e),s.push({listener:t,eventType:n,data:i})}),s}}]),t}(),u=new t("update"),a=function(){function n(t,e){s(this,n),this.events=t,this.history=e,this.maps={},u.implementedBy(this)}return e(n,[{key:"update",value:function(t){var e=new this.maps[t.eventType](t);this.history&&(e.saveState(),this.history.push(e)),e.execute()}},{key:"undo",value:function(){this.history&&this.history.pop().undo()}},{key:"mapCommand",value:function(t,e){this.events.subscribe(e,this),this.maps[e]=t}},{key:"unmapCommand",value:function(t,e){this.events.unsubscribe(e,this),delete this.maps[e]}}]),n}();return{Context:function(){function n(t,e){s(this,n),this.events=new o,this.history=new r,this.mapper=new a(this.events,this.history),this.mapCommands(e),this.injectChildren(t)}return e(n,[{key:"mapCommands",value:function(n){var i=this;Object.keys(n).forEach(function(t,e){i.mapper.mapCommand(n[t],t)})}},{key:"injectChildren",value:function(t){var e=t.$options;e.context?t.$context=this:e.parent&&e.parent.$context&&(t.$context=e.parent.$context)}}]),n}(),IEventListener:u,EventManager:o,HistoryManager:r,Mapper:a,Interface:t}});